# Описание проекта
Проект вкючает в себя код для работы с предобученной моделью YOLOv8 для сегментации людей в толпе. Логика заключается в том, что на вход модели подается видео в формате mp3, и она возвращает расположение масок людей, которые в дальнейшем накладываются на результирующее видео с наименованием класса и уровнем уверенности. 
Структура проекта состоит из:
1) data - папка, содержащая файл crowd.mp3. После выполнения программы в данной папке будет содержаться результирующий файл segmented_crowd.mp4
2) main.py - точка входа в программу. Здесь описывается сама логика работы
3) requirements.txt - файл с версиями библиотек и зависимостями
4) Dockerfile - содержит инструкции для сбора образа

# Инструкция по запуску программы
1) Создайте папку у себя на компьютере, где будет располагаться проект
2) Откройте данную папку через терминал и выполните команду git clone https://github.com/ITProger123/segmentation_crowd.git
3) Далее переходим в склонированный репозиторий с прмощью команды cd segmentation_crowd
4) Установите docker с официального сайта. Это необходимо, чтобы программа смогла работать на любой ОС
5) Запустите docker и выполните команду docker build -t segmented_crowd .
6) В результате создается образ segmented_crowd. Можете проверить результат с помощью команды docker images.
7) Далее необходимо сконфигурировать контейнер на основе данного образа. Для этого выполните команду: docker run --name crowded_segment_cont --mount type=bind,source='<Имя вашей директории>/data',target='/app/data' segmented_crowd
Пояснение:
  - В параметре source необходимо передать ваш полный путь до папки data. Команда mount монтируют Вашу директорию с папкой data с директорией /app/data в контейнере. Это небходимо для передачи результата работы программы из контейнера в вашу директорию.
  - Если выдается ошибка (особенно на Mac OS), то необходимо добавить путь в source в docker desktop. Для этого заходим в docker desktop, далее Settings -> Resources -> File sharing. Нажимаем плюс и добавляем путь до папки data. Затем нажимаем Apply & restart. Далее запустите команду заново
8) Если все сработало, то в терминале появиться процесс загрузки модели YOLOv8 и начнется покадровая сегментация. Время выполнения программы примерно 25-30 минут в зависимости от мощности вашего компьютера
9) После выполнения программы в папке data появиться файл segmented_crowd.mp4 , в котором будет результат сегментации

# Выводы
1) В результате работы программы вы получаете файл с размеченными людьми на видео
2) Основная проблема заключается в том, что модели тяжело распознавать людей именно в толпе, так как она пытается выявить силуэт человека на видео, а когда у нас большое скопление людей, то некоторые выделяются неявно (видна только голова и т.д.), что также отражается и на уровне уверенности.
3) Как можно улучшить? Если предполагается, что модель должна работать в условиях большого скопления людей, то можно выполнить дополнительную разметку людей в толпе, то есть относить к классу person также неполлный силуэт человека. Затем дообучить модель на новых размеченных данных. Это позволит модели выделять на видео людей, который полностью не попадают в кадр
